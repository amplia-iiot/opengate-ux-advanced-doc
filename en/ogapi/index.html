<!DOCTYPE html>
<html lang="English">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>OGAPI: An API for the API | UX Advanced features</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="Quick Start">
    
    <link rel="preload" href="/assets/css/0.styles.2a539a30.css" as="style"><link rel="preload" href="/assets/js/app.575068f5.js" as="script"><link rel="preload" href="/assets/js/2.1717deca.js" as="script"><link rel="preload" href="/assets/js/10.f1829f3e.js" as="script"><link rel="prefetch" href="/assets/js/11.4a37e105.js"><link rel="prefetch" href="/assets/js/12.7f21ecbc.js"><link rel="prefetch" href="/assets/js/13.c61552e7.js"><link rel="prefetch" href="/assets/js/14.b915bb67.js"><link rel="prefetch" href="/assets/js/15.7aadd0cf.js"><link rel="prefetch" href="/assets/js/16.876c6529.js"><link rel="prefetch" href="/assets/js/17.f64c3fb6.js"><link rel="prefetch" href="/assets/js/18.f4aed6de.js"><link rel="prefetch" href="/assets/js/19.aec57a2d.js"><link rel="prefetch" href="/assets/js/20.ece6d164.js"><link rel="prefetch" href="/assets/js/21.543b9ede.js"><link rel="prefetch" href="/assets/js/3.46232e64.js"><link rel="prefetch" href="/assets/js/4.50f150c1.js"><link rel="prefetch" href="/assets/js/5.c8cd2e82.js"><link rel="prefetch" href="/assets/js/6.3bc4acb2.js"><link rel="prefetch" href="/assets/js/7.fcba4203.js"><link rel="prefetch" href="/assets/js/8.4cfa08e3.js"><link rel="prefetch" href="/assets/js/9.761f59e9.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2a539a30.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/en/" class="home-link router-link-active"><img src="/logo/opengate.png" alt="UX Advanced features" class="logo"> <span class="site-name can-hide">UX Advanced features</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/en/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/en/wiwis/" class="nav-link">
  WiWi Development Kit (WWDK)
</a></div><div class="nav-item"><a href="/en/views/" class="nav-link">
  Custom Views
</a></div><div class="nav-item"><a href="/en/ogapi/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  OGAPI
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ogapi/" class="nav-link">
  Español
</a></li><li class="dropdown-item"><!----> <a href="/en/ogapi/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/en/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/en/wiwis/" class="nav-link">
  WiWi Development Kit (WWDK)
</a></div><div class="nav-item"><a href="/en/views/" class="nav-link">
  Custom Views
</a></div><div class="nav-item"><a href="/en/ogapi/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  OGAPI
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ogapi/" class="nav-link">
  Español
</a></li><li class="dropdown-item"><!----> <a href="/en/ogapi/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>OGAPI: An API for the API</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/en/ogapi/#what-is-ogapi" class="sidebar-link">What is OGAPI?</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/en/ogapi/#opensource-project" class="sidebar-link">OpenSource Project</a></li><li class="sidebar-sub-header"><a href="/en/ogapi/#getting-started" class="sidebar-link">Getting Started</a></li></ul></li><li><a href="/en/ogapi/#hello-ogapi" class="sidebar-link">Hello OGAPI!!!</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/en/ogapi/#adding-the-ogapi-dependency" class="sidebar-link">Adding the OGAPI dependency</a></li><li class="sidebar-sub-header"><a href="/en/ogapi/#creating-an-instance" class="sidebar-link">Creating an instance</a></li><li class="sidebar-sub-header"><a href="/en/ogapi/#test" class="sidebar-link">Test</a></li></ul></li><li><a href="/en/ogapi/#what-else-can-you-do-with-ogapi" class="sidebar-link">What else can you do with OGAPI ?</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/en/ogapi/#searching-through-ogapi" class="sidebar-link">Searching through OGAPI</a></li><li class="sidebar-sub-header"><a href="/en/ogapi/#provision-through-ogapi" class="sidebar-link">Provision through OGAPI</a></li><li class="sidebar-sub-header"><a href="/en/ogapi/#performing-operation-through-ogapi" class="sidebar-link">Performing Operation through OGAPI</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="ogapi-an-api-for-the-api"><a href="#ogapi-an-api-for-the-api" class="header-anchor">#</a> OGAPI: An API for the API</h1> <h2 id="what-is-ogapi"><a href="#what-is-ogapi" class="header-anchor">#</a> What is OGAPI?</h2> <p>OGAPI is a javascript solution, born to help the integration with <a href="https://www.amplia-iiot.com/documentation/latest/" target="_blank" rel="noopener noreferrer">OpenGate API REST<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>It makes a way easier and cleaner the integration with the different services provide by Opengate. It is developed under NodeJS, however you could use it into the browser because it is an isomorphic javascript API.</p> <h3 id="opensource-project"><a href="#opensource-project" class="header-anchor">#</a> OpenSource Project</h3> <p>Besides, <em>OGAPI</em> is OpenSource. You can find it on <a href="https://github.com" target="_blank" rel="noopener noreferrer">github<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, it is called <em>opengate-js</em>.</p> <blockquote><p><a href="https://github.com/amplia-iiot/opengate-js" target="_blank" rel="noopener noreferrer">opengate-js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h3 id="getting-started"><a href="#getting-started" class="header-anchor">#</a> Getting Started</h3> <p>In order to be able to use it on your project, you should add it as a dependency on <em>package.json</em> file, or, install it straightaway with npm</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ <span class="token function">yarn</span> <span class="token function">add</span> amplia-iiot/opengate-js
</code></pre></div><p>or</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ <span class="token function">npm</span> <span class="token function">install</span> amplia-iiot/opengate-js
</code></pre></div><h2 id="hello-ogapi"><a href="#hello-ogapi" class="header-anchor">#</a> Hello OGAPI!!!</h2> <h3 id="adding-the-ogapi-dependency"><a href="#adding-the-ogapi-dependency" class="header-anchor">#</a> Adding the OGAPI dependency</h3> <p>Remember, you should make the correct import, by correct import we mean that you should reference in the import statement the installed version. This is necessary just on browser.</p> <p><strong>NODEJS</strong>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> ogapi <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'opengate-js'</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>HTML</strong>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'opengate-js/dist/opengate-api-bower-7.2.0'</span>
</code></pre></div><p>or</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;opengate-js/dist/opengate-api-bower-7.2.0&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><p><strong>HTML</strong>: <a href="https://www.w3schools.com/tags/att_script_src.asp" target="_blank" rel="noopener noreferrer">HTML Import<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>This isn't necessary to develop WiWis, everything is set under the <a href="/wiwis/development.html#api">$api</a> object</p></div> <h3 id="creating-an-instance"><a href="#creating-an-instance" class="header-anchor">#</a> Creating an instance</h3> <p>Before using it, you should create an instance, we show you down below how to do so:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> $api <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OpenGateAPI</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    apiKey<span class="token operator">:</span> <span class="token string">'OPENGATE API-KEY'</span><span class="token punctuation">,</span> 
    url<span class="token operator">:</span> <span class="token string">'NORTH OPENGATE API URL (*)'</span><span class="token punctuation">,</span>
    timeout<span class="token operator">:</span> <span class="token number">120000</span><span class="token punctuation">,</span> <span class="token comment">// Request timeout</span>
    south<span class="token operator">:</span> <span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token string">'SOUTH OPENGATE API URL (*)'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><details class="custom-block details"><summary>Services provided by OpenGate available on this url</summary> <p><strong>North Api</strong>: https://api.opengate.es/north/v80</p> <p><strong>South Api</strong>: https://api.opengate.es/south/v80</p></details> <h3 id="test"><a href="#test" class="header-anchor">#</a> Test</h3> <p>Once you have created an instance, we are goint to check if all is right. To do so, you can perform your first searching. We show you how to make a easy one.
With this you will ask for all the reachables domains by the given apy-key:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>$api<span class="token punctuation">.</span><span class="token function">domainsSearchBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>OGAPI has been developed following the <a href="https://en.wikipedia.org/wiki/Fluent_interface#JavaScript" target="_blank" rel="noopener noreferrer">Fluent Interface<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> standart</p></blockquote> <h2 id="what-else-can-you-do-with-ogapi"><a href="#what-else-can-you-do-with-ogapi" class="header-anchor">#</a> What else can you do with OGAPI ?</h2> <p>Opengate provides a huge amount of services such as provision, searching, operations, recollecting data, and so forth.</p> <p>Right below you will find some examples with OGAPI and the REST equivalent. These examples gather the most used services.</p> <h3 id="searching-through-ogapi"><a href="#searching-through-ogapi" class="header-anchor">#</a> Searching through OGAPI</h3> <p>Now, you will be shown the same searching but on different Opengate endpoints.</p> <h4 id="entity-searching"><a href="#entity-searching" class="header-anchor">#</a> Entity searching</h4> <p>In order to perform an entity searching, you should do as follow:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">curl</span> --request POST <span class="token punctuation">\</span>
     --data-binary @filter.json <span class="token punctuation">\</span>
     --header <span class="token string">&quot;X-ApiKey: YOUR_API_KEY_HERE&quot;</span> <span class="token punctuation">\</span>
     --verbose <span class="token punctuation">\</span>
     http://<span class="token punctuation">[</span>your_opengate_address<span class="token punctuation">]</span>/north/v80/search/devices?flattened<span class="token operator">=</span>true
</code></pre></div><details class="custom-block details"><summary>filter.json</summary> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;and&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;like&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;resourceType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;entity.asset&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></details> <p>OGAPI code</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>$api<span class="token punctuation">.</span><span class="token function">entitiesSearchBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">flattened</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;like&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token string">&quot;resourceType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;entity.asset&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="provision-through-ogapi"><a href="#provision-through-ogapi" class="header-anchor">#</a> Provision through OGAPI</h3> <p>Now, you will be shown the same provision but on different Opengate endpoints.</p> <h4 id="channel-provision"><a href="#channel-provision" class="header-anchor">#</a> Channel provision</h4> <p>Example of doing that through OpenGate API REST</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">curl</span> --request POST <span class="token punctuation">\</span>
     --data-binary @channel.json <span class="token punctuation">\</span>
     --header <span class="token string">&quot;X-ApiKey: YOUR_API_KEY_HERE&quot;</span> <span class="token punctuation">\</span>
     --verbose <span class="token punctuation">\</span>
     http://<span class="token punctuation">[</span>your_opengate_address<span class="token punctuation">]</span>/north/v80/provision/organizations/<span class="token punctuation">{</span>organizationName<span class="token punctuation">}</span>/channels <span class="token punctuation">\</span>
     -H <span class="token string">&quot;Content-type: application/json&quot;</span>
</code></pre></div><details class="custom-block details"><summary>channel.json</summary> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;channel&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;battery_channel&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;channel description&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;certificates&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;certificate1_id&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;certificate2_id&quot;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></details> <p>OGAPI code</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>$api<span class="token punctuation">.</span><span class="token function">channelsBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">withOrganization</span><span class="token punctuation">(</span><span class="token punctuation">{</span>organizationName<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">withName</span><span class="token punctuation">(</span><span class="token string">'batteryChannel'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">withDescription</span><span class="token punctuation">(</span><span class="token string">'channel description'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">withCertificate</span><span class="token punctuation">(</span><span class="token string">'certificate1_id'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">withCertificate</span><span class="token punctuation">(</span><span class="token string">'certificate2_id'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="ticket-provision"><a href="#ticket-provision" class="header-anchor">#</a> Ticket provision</h4> <p>OpenGate allows you to shape some of its entities (devices, assets and tickets), thanks to the datamodels, so you could define it behaviour focusing in every detail. OGAPI will modify its structure according with the selected entity model, for the purpose of helping as much as possible in the provisión process.</p> <p>This is a ticket provision example through OGAPI:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// Firstly the builder is called to create a customized builder depending on the entity's datamodels</span>
$api<span class="token punctuation">.</span>entityBuilder
    <span class="token punctuation">.</span><span class="token function">ticketsBuilder</span><span class="token punctuation">(</span>organization<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">builder</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        builder<span class="token punctuation">.</span><span class="token function">with</span><span class="token punctuation">(</span><span class="token string">'provision.ticket.identifier'</span><span class="token punctuation">,</span> <span class="token string">'nuevo identificador'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">with</span><span class="token punctuation">(</span><span class="token string">'provision.ticket.name'</span><span class="token punctuation">,</span> <span class="token string">'Nombre del ticket'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">with</span><span class="token punctuation">(</span><span class="token string">'provision.ticket.type'</span><span class="token punctuation">,</span> <span class="token string">'WORKORDER'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">with</span><span class="token punctuation">(</span><span class="token string">'provision.ticket.severity'</span><span class="token punctuation">,</span> <span class="token string">'CRITICAL'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><blockquote><p>All the entities builders have the same above behaviour.</p></blockquote> <h3 id="performing-operation-through-ogapi"><a href="#performing-operation-through-ogapi" class="header-anchor">#</a> Performing Operation through OGAPI</h3> <p>You will find similarities between performing operations and making searching through OGAPI.
Firstly.. Can you guess ?
Yes, you have to call the builder giving the operation name to it. This is because each operation has a different set of parameters and the created builder knows all of them, so it will help you filling them.
In base of the filled parameters, OGAPI will know when an operation is periodic or not (job or task), so you don't need to care about it, OGAPI will do it for yourself.</p> <h4 id="getting-the-operation-catalog"><a href="#getting-the-operation-catalog" class="header-anchor">#</a> Getting the operation catalog</h4> <p>Some of the operations aren't developed on OGAPI yet, nevertheless it let you perform them. In this case, to do so you should use <em>rawSearchBuilder</em>.
The code below shows you how to get the operation catalog:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>$api<span class="token punctuation">.</span><span class="token function">rawSearchBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">'/catalog/operations'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="performing-operations"><a href="#performing-operations" class="header-anchor">#</a> Performing operations</h4> <p>Once we know which operations are availables, we go ahead with building and executing our operation.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>$api<span class="token punctuation">.</span>operations
    <span class="token punctuation">.</span><span class="token function">builderByOperationName</span><span class="token punctuation">(</span><span class="token string">'identificador de operación'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">operationBuilder</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        builder<span class="token punctuation">.</span><span class="token function">withAckTimeout</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>timers<span class="token punctuation">.</span>acktimeout <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'seconds'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">withJobTimeout</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>timers<span class="token punctuation">.</span>stop<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">withTimeout</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>timers<span class="token punctuation">.</span>timeout<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'seconds'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">withRetries</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>timers<span class="token punctuation">.</span>retries <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">withRetriesDelay</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>timers<span class="token punctuation">.</span>retriesDelay <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'seconds'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">withNotes</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>userNotes <span class="token operator">||</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">withCallback</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>callback <span class="token operator">||</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>appendEntitiesBy
                <span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'entidad1'</span><span class="token punctuation">,</span> <span class="token string">'entidad2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">OGAPI extended documentation</p> <p>You will find the extended documentation in the <a href="https://github.com/amplia-iiot/opengate-js/tree/master/documentation" target="_blank" rel="noopener noreferrer">OGAPI github repository<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.575068f5.js" defer></script><script src="/assets/js/2.1717deca.js" defer></script><script src="/assets/js/10.f1829f3e.js" defer></script>
  </body>
</html>
